select __time, id_station, <sid> FROM d1_wide where id_station in <stid> and __time > TIMESTAMP '<timestamp>' - INTERVAL '<nb>' <rangesUnit> and __time < TIMESTAMP '<timestamp>'
SELECT __time, id_station, <sid> FROM d1_wide WHERE  id_station in <stid> AND __time > TIMESTAMP '<timestamp>' - INTERVAL '<nb>' <rangesUnit> and __time < TIMESTAMP '<timestamp>' AND <sfilter>
select id_station,<avg_s>  FROM d1_wide where __time > TIMESTAMP '<timestamp>' - INTERVAL '<nb>' <rangesUnit> \ and __time < TIMESTAMP '<timestamp>' AND id_station in <stid> GROUP BY id_station
SELECT "id_station", TIME_EXTRACT(__time, 'YEAR')  AS "yearP", TIME_EXTRACT(__time, 'MONTH') AS "month", TIME_EXTRACT(__time, 'DAY') AS "day", TIME_EXTRACT(__time, 'HOUR') AS "hour", <avg_s> FROM d1_wide where __time > TIMESTAMP '<timestamp>' - INTERVAL '<nb>' <rangesUnit> AND __time < TIMESTAMP '<timestamp>' and id_station in <stid> GROUP BY 1,2,3,4,5
EMPTY
with data1 as ( select __time, s<sid1> as s_1 from d1_wide WHERE __time > TIMESTAMP '<timestamp>' - INTERVAL '<nb>' <rangesUnit> AND __time < TIMESTAMP '<timestamp>' AND st='st<stid1>' ), data2 as ( select __time, s<sid2> as s_2 from d2_hour WHERE __time > TIMESTAMP '<timestamp>' - INTERVAL '<nb>' <rangesUnit> AND __time < TIMESTAMP '<timestamp>' AND st='st<stid2>' ) select data1.__time, s_1, s_2, (s_1 + s_2)/2 as avgst from data1 JOIN data2 ON data1.__time = data2.__time
WITH t1 AS ( SELECT "__time", s<sid1> as s1 FROM d1_wide WHERE "st"='st<stid>' AND "__time" > TIMESTAMP '<timestamp>' - INTERVAL '<nb>' <rangesUnit> and "__time" < TIMESTAMP '<timestamp>' ), t2 AS ( SELECT "__time", s<sid2> as s2 FROM d2_hour WHERE "st"='st1' AND "__time" > TIMESTAMP '<timestamp>' - INTERVAL '<nb>' <rangesUnit> and "__time" < TIMESTAMP '<timestamp>' ) SELECT ((SUM(s1 * s2) - (SUM(s1) * SUM(s2)) / COUNT(*))) / (SQRT(SUM(s1 * s1) - (SUM(s1) * SUM (s1)) / COUNT(*)) * SQRT(SUM(s2 * s2) - (SUM(s2) * SUM(s2)) / COUNT(*) )) AS pearson_corr FROM t1, t2 WHERE t1."__time" = t2."__time"
